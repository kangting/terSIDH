
#include <params.h>


const uint64_t pbits = 1569;

uint_custom const uint_custom_0 = {{0}};
uint_custom const uint_custom_1 = {{1}};
uint_custom const uint_custom_2 = {{2}};

const struct uint_custom p = {{
    0xc336d403441d1673, 0x8bf2e7e4803b30e0, 0x2a661acf50bef842, 0x3589309c6d6fb290, 
    0xceb91dd657963803, 0xc643cbd852e1df22, 0x89a53ca2d9ff7be0, 0x4aa06bbd5330aa5c, 
    0xaf0f500678ce43c0, 0xd7ae83d197dd3c3a, 0x4d7ae2e620770445, 0x02061cd2ac3980ef, 
    0x30d3fe85d876c130, 0xda00b17f678b9fd5, 0xcfba1dcf6d5aee50, 0xa8f5bf657c413831, 
    0xae37c79d9310610c, 0x7d3149bc796dc078, 0xb92240db803155b1, 0x2ea2ab0009209605, 
    0x754f4fce8d562a0d, 0xa6c650682fccc2b4, 0x209e45c3864af514, 0x48aaa2630823f4a8, 
    0x00000003bcded628,
}};

/* points */
const struct uint_custom2 PA = {{{
    0xf7dbe9bdeb78ba45, 0x5f8d55b247e79ac5, 0x168b03eac1612046, 0x65251dd87aad65b0, 
    0xda9d904e511e3ebd, 0x7a3bd844f2272524, 0x84a74d8596636463, 0xeee5403e9dccbbbf, 
    0xf1b37ae1cce0bac3, 0x87a92365f00c5769, 0x3e1b677c4a44fcfb, 0x1da92c8314233c4a, 
    0x852fda1f58726691, 0x43c1adb3f69b2016, 0xe4d571faee0fb581, 0xd1c803407ef10144, 
    0x8583704e5cc75c7f, 0xc5efc838af3db8ee, 0xdef7bf9b2bafe08b, 0xc38dc4b4a075e96a, 
    0xffdbd2bc3e06a8bb, 0xf0aa7394cbb1e44d, 0x9605d54ad9ff3eee, 0x34ad55d2d8379f76, 
    0x000000022012d438
    }}, {{
    0xdbc56d622bb864b9, 0x58a0a5ceb78bfba9, 0x52a1c32a50fcd9cb, 0xe60ac5b306aa51ff, 
    0x7387297c14e297f4, 0xcaad905138aad587, 0xfe3163a9dfa27d99, 0xb2a59edd07d6d63c, 
    0x85cc17390e5ff4e2, 0xb970d11aa5032299, 0x02c9287e8cfaac40, 0xfd1934dcfc6fc429, 
    0x23a6f24aec5b6b9a, 0xd5085d3ff93a5ccd, 0x3ae14372d5170938, 0x00b4ef9c4ebf2ce9, 
    0xf9c5014a465ea47c, 0xc6dc66973d1f67fb, 0x042e81fd13ff09ad, 0x422d87a709f82e8d, 
    0x5d8eadc09360302e, 0x625aaed4bb1889de, 0xf14070e9a9e4a7c4, 0xa61c61b06aff322a, 
    0x000000000aa05a75,
}}};
const struct uint_custom2 QA = {{{
    0x9ec3215d5b31685c, 0x7dc0ed3baa79f755, 0x14da124bf5e3920d, 0x878ca4d597c79ddc, 
    0x0281f829eff7755a, 0xe459429e8ef6722f, 0x5c36b941025f25a5, 0xfa382cc4c38c037f, 
    0xa3ce560d9c9fbe45, 0x026845be9ebfccb8, 0x83d8219d7c355c11, 0xb9447867d89b7641, 
    0x7efb832d1a1bff53, 0x0f4ce3c35f82a6ed, 0x200fefcf9568dce8, 0x3d6f03a0a19e22f1, 
    0x8e5fb65e9d14a626, 0x2adbda0ebb97e031, 0xf1861f5a582321de, 0xfc2fd6054a07544d, 
    0xe986592f1c67e41d, 0x8894a5dc150423c6, 0x447ea71846f3c780, 0xf7d4d16091355f3b, 
    0x00000001f54267c0,
    }}, {{
    0x622dacfb5356654b, 0x9cddad46abc7c77f, 0x166debf2bfea829b, 0x6ec276b91ce48464, 
    0xcab542e07480189f, 0xbe74a7bd2e92a9c3, 0xb9bb34e9d11df25e, 0xf7e255fea35faf86, 
    0xb063db956fb88784, 0x5acac2a713002876, 0x705730f4310233f0, 0x0c063652cb5da240, 
    0x46a1d28ddf3ffbf0, 0x92c729d2d6085398, 0xb1c8fd6f9222c69d, 0x6db1635ca6dd7757, 
    0x62ddad85834dbe00, 0xb4264235884c4801, 0x943a6cd355442672, 0xc5a019b29e8477cc, 
    0xec015421fc803c06, 0xd94c7965f5fefcca, 0xca682b2ed6ed1496, 0x8f92453b9e7b5c9b, 
    0x00000003b02757ea,
}}}; 
const struct uint_custom2 PB = {{{
    0x82c47a60071fa63f, 0x40b3dd80d0b7561d, 0x7d9d0ae6ac1587d5, 0xa0f0270d4e5c1181, 
    0x42a58de6555b43d8, 0xcb439e0715a25c2d, 0x3a75ff9a8f3e8a44, 0x724259d904dc91bb, 
    0xb82a9d39a1cf9d19, 0x8d049c7aa1d3df71, 0x9c6bfd9622e9aac7, 0xd8b9783c5a9619fb, 
    0x56c0001a845d5009, 0xa315c7357dbd2622, 0x9c8c9ded51cd471f, 0x8622f31a3932e0ad, 
    0xd70a7429be3e76e4, 0x8459a5bd06328dee, 0x7e2049dbe293e4a9, 0x65ca7fc1d3c4a91c, 
    0xc56361b5e9e4e75c, 0x8bc11e830e522679, 0x5ebb814139e63123, 0x81e04f68f02326c6, 
    0x00000001a08e7c73,
    }}, {{
    0xf314be903cf6eeae, 0x59dff9e2b512caa9, 0x82afb575ed85ffcb, 0xd936dcee1fa46d63, 
    0xfdccd369cd437e5d, 0x2fac9c3fb57c6c39, 0x96761224bb423de0, 0xf62794f4daba6d1e, 
    0x5e5edc4cac7c2a87, 0xe4687485a81c4258, 0xf1450cce2641db08, 0xbd3c6cc291159c7f, 
    0x00cbb0c1ec03c358, 0xe4dc488fdb059bd7, 0x45cdc67744a7c267, 0x8461f1dd58095c7b, 
    0x6ea4f01ffaa36169, 0x07c7747d193a4581, 0xc9c0898198d91070, 0xca0b9ea278c4e043, 
    0x5561d4aaa7aa76bc, 0x755c049b00a02a8c, 0x0c4727d5b1fcc061, 0xd083d623e5c22b57, 
    0x000000023cdde0ef,
}}};
const struct uint_custom2 QB = {{{
    0x1d49b5003d290bc9, 0xe5a026fc644f0a3b, 0xfb70c26cd68e5244, 0x3d051c5ab574a750, 
    0x321fd608cb13d0ba, 0x88094cc58bf32224, 0x117af50f64defce9, 0xe718b02790d21a25, 
    0x78cf52b380c63a7c, 0x8e1fd33f10e3a401, 0xb41e9ac51082061f, 0xd2b92950ea915fb8, 
    0xa2ea574fafcce7d9, 0xa4965272626fbd24, 0xe4fdb67e2b7adff1, 0x807809450e32790c, 
    0xdf26adad638bd3a7, 0xc5bb67c9b09088fa, 0xf7f8020b95c27b45, 0x62856e8b68914cb3, 
    0x5f6b43a515b19195, 0xc082f03cec764021, 0x82f478ed809d9198, 0x78a24d56b6af06b5, 
    0x00000000793eea5e,
    }}, {{
    0x7965b37f77e353d6, 0x4a24c3dc4c4a3a3e, 0x22640e7fd7f38437, 0x1bdd1ed60dd167a9, 
    0xf76aa2de821a1db2, 0x275c4f0c69b899fb, 0xdce497699709ca59, 0xaef302e13a76e04f, 
    0xe1f1f9fa92973e34, 0x8fb17dd3b644d1b4, 0x4908a484a949004b, 0x28b02316f42b27b5, 
    0x7da603c5b48b96c7, 0xe5309d5ace469427, 0xf43df0e2c85f3661, 0xa8b14758c63eb636, 
    0xc81153b7e9c3b871, 0x1dfe30ce285a908a, 0xc4841f6fd18256a3, 0x7f885e85e5036624, 
    0x0d3b733689030eee, 0x1fbaa735145d9da6, 0xa70aafc6d3eb4cb5, 0x5dcada1123d2ae28, 
    0x00000002f3598e3c,
}}};

// x(pA-QA)
const struct uint_custom2 PQA = {{{
    0x5918c860904751e9, 0xe1cc68769d6da370, 0x01b0f19ecb7d8e38, 0xdd987902e2e5c7d4, 
    0xd81b98246126c962, 0x95e295a66330b2f5, 0x2870944494043ebd, 0xf4ad1379da40b840, 
    0x4de524d43040fc7d, 0x8540dda7514c8ab1, 0xba4345dece0fa0ea, 0x6464b41b3b87c608, 
    0x063456f23e56673d, 0x3474c9f097187929, 0xc4c5822b58a6d899, 0x9458ff9fdd52de53, 
    0xf723b9efbfb2b659, 0x9b13ee29f3a5d8bc, 0xed71a040d38cbead, 0xc75deeaf566e951c, 
    0x1655798d219ec49d, 0x6815cdb8b6adc087, 0x51872e32930b776e, 0x3cd884724702403b, 
    0x000000002ad06c77,
    }}, {{
    0x75202537706bc905, 0x7a7417c6d8285290, 0x5ad27b00a523d269, 0xde663875c9af4df0, 
    0x83def18eceee659a, 0xd22da5cb991e5ae6, 0x72ebc642a733482b, 0xf9998860edd1e426, 
    0x2cb0c56ff921e17a, 0xe6558bcf0dc18f84, 0xa2cec3afcf8e5942, 0xea06983ffd0a8c9f, 
    0x748f738783977d9a, 0x062cb20729122f6b, 0x1e0d5f239872e29e, 0x58e0e9189712894f, 
    0xeaaf1dc5459bec84, 0xacdba0a776aebfd6, 0x90696ec04f29dea8, 0xbf3abc518467e7b1, 
    0x2007825361100269, 0x52e64db7f582ee7b, 0x929a85a925c76330, 0xb234433bd166de6d, 
    0x0000000003577744,
}}};

// x(pB-QB)
const struct uint_custom2 PQB = {{{
    0x657ac55fc9f69a76, 0x5b13b6846c684be2, 0x822c4879d5873590, 0x63eb0ab298e76a30, 
    0x1085b7dd8a47731e, 0x433a514189af3a09, 0x28fb0a8b2a5f8d5b, 0x8b29a9b1740a7796, 
    0x3f5b4a862109629c, 0xfee4c93b90f03b70, 0xe84d62d11267a4a7, 0x06004eeb7004ba42, 
    0xb3d5a8cad4906830, 0xfe7f74c31b4d68fd, 0xb78ee76f2652672d, 0x05aae9d52b0067a0, 
    0xf7e3c67c5ab2a33d, 0xbe9e3df355a204f3, 0x862847d04cd16963, 0x034511366b335c68, 
    0x65f81e10d43355c7, 0xcb3e2e4621dbe658, 0xdbc70853b9489f8a, 0x093e021239742010, 
    0x00000001274f9215,
    }}, {{
    0x75376fe15d1d646f, 0xce6c5545352caed1, 0x7eea4abf29a3f6cd, 0x2477a793f1bc860f, 
    0xe16f3b7e79b546f1, 0xce450a6adaca0160, 0xe807123dbce73077, 0x860ad196299e4a3e, 
    0xd3b56c1e745f6070, 0xdc66740d6d960604, 0xb899346ef08ebbaf, 0x8d7fe36168e2df81, 
    0x1ab000c6adf43a81, 0xc39729cf129f2de6, 0xe684eeb4d1c72c08, 0xa18e075d80fb7a01, 
    0xfa5b6668936aaf00, 0x83eebff4b2bb54d2, 0x25b1c3a857c5b53a, 0x8d308e79acb5ab10, 
    0xf6a08a28e8d77610, 0x1f7975af1cabee4d, 0xd0feb7fd30e143af, 0x0e6322d9c6d2860c, 
    0x00000002f262c76d,
}}};

/* (p+1)/prod(primes) */
const struct uint_custom p_cofactor = {{1}};          /* matches baked PA/PB/... */
const struct uint_custom p_cofactor_runtime = {{363}}; /* for runtime generator */

const struct fp fp_0 = {{0}};

/* 2^1600 mod p */
const struct fp fp_1 = {{
    0xfb8864d09809c997, 0xbeb11f3ecc641e65, 0x1e9ea3c914117b39, 0x671de97bdfe98055, 
    0xdb0d0af32e8be645, 0xc5f4bd378f062f22, 0x2e75978298aebcf0, 0x3ed63f82895abd70, 
    0x574889cc5a7a741d, 0x87af7d5b7bbe9561, 0x105ccc257395e0f2, 0xf8f399b5cbf86ab7, 
    0x978a53ca767c0def, 0xc3eb7e9a05e02636, 0x94f51920557ea002, 0xc5dd5cd8ef30d3bd, 
    0x53c7ca00828b0608, 0x9a257c45c1db9fdc, 0x20755996906efb6d, 0x42ad4e5d18f430f1, 
    0xae7a28b4ca300e42, 0xc9d8184930696167, 0x6bc23fee52cfd002, 0x9baa26c704e308de, 
    0x00000003a8de74b9,
}};

const struct fp fp_2 = {{
    0x33d9f59debf67cbb, 0xf16f5699188d0beb, 0x12d72cc2d763fe30, 0x98b2a25b52634e1a, 
    0xe760f81005819487, 0xc5a5ae96cb2a7f22, 0xd345f262575dfe00, 0x330c1347bf84d083, 
    0xff81c3923c26a47a, 0x37b076e55f9fee87, 0xd33eb564c6b4bd9f, 0xefe11698ebb7547e, 
    0xfe40a90f14815aaf, 0xadd64bb4a434ac97, 0x5a3014713da251b4, 0xe2c4fa4c62206f49, 
    0xf957cc637205ab04, 0xb719aecf0a497f3f, 0x87c87251a0aca129, 0x56b7f1ba28c7cbdc, 
    0xe7a5019b0709f277, 0xece9e02a3106001a, 0xb6e63a191f54aaf0, 0xeea9ab2b01a21d14, 
    0x0000000394de134a,
}};

const struct fp fp_2_inv = {{
    0x33d9f59debf67cbb, 0xf16f5699188d0beb, 0x12d72cc2d763fe30, 0x98b2a25b52634e1a, 
    0xe760f81005819487, 0xc5a5ae96cb2a7f22, 0xd345f262575dfe00, 0x330c1347bf84d083, 
    0xff81c3923c26a47a, 0x37b076e55f9fee87, 0xd33eb564c6b4bd9f, 0xefe11698ebb7547e, 
    0xfe40a90f14815aaf, 0xadd64bb4a434ac97, 0x5a3014713da251b4, 0xe2c4fa4c62206f49, 
    0xf957cc637205ab04, 0xb719aecf0a497f3f, 0x87c87251a0aca129, 0x56b7f1ba28c7cbdc, 
    0xe7a5019b0709f277, 0xece9e02a3106001a, 0xb6e63a191f54aaf0, 0xeea9ab2b01a21d14, 
    0x0000000394de134a,
}};

const struct fp2 fp2_0 = {{{0}}, {{0}}};

const struct fp2 fp2_1 = {{{
    0xfb8864d09809c997, 0xbeb11f3ecc641e65, 0x1e9ea3c914117b39, 0x671de97bdfe98055, 
    0xdb0d0af32e8be645, 0xc5f4bd378f062f22, 0x2e75978298aebcf0, 0x3ed63f82895abd70, 
    0x574889cc5a7a741d, 0x87af7d5b7bbe9561, 0x105ccc257395e0f2, 0xf8f399b5cbf86ab7, 
    0x978a53ca767c0def, 0xc3eb7e9a05e02636, 0x94f51920557ea002, 0xc5dd5cd8ef30d3bd, 
    0x53c7ca00828b0608, 0x9a257c45c1db9fdc, 0x20755996906efb6d, 0x42ad4e5d18f430f1, 
    0xae7a28b4ca300e42, 0xc9d8184930696167, 0x6bc23fee52cfd002, 0x9baa26c704e308de, 
    0x00000003a8de74b9,
}}, {{0}}};

const struct fp2 fp2_6 = {{{
    0x152038d33ba9494b, 0xbc6834024930c200, 0xe3b950a9e4ae0a0d, 0x5f0585d91c4a852d,
    0x18b0ac8361584d90, 0xc4697413bbbbbf23, 0x66875de1521b0240, 0x03e3625c982d1cd2,
    0xa066aaa9c2d765ee, 0xf7b45d0cef255322, 0xdec65a6213303051, 0xcb970a256ab2fb9d,
    0x9919fe218c968daf, 0x5581801f1d86c61d, 0x6f1c01b4de31187c, 0x5663701a2ddedd78, 
    0x8f97d5ef2ff03ef5, 0x2aea78f42c00fcce, 0x2514d53de1a3381a, 0xa6e27f2e6816378a, 
    0xcc506533fa71834b, 0x7930ffae33787ae7, 0xe37622c4516816a9, 0x3aa7bcbaf49e6ded, 
    0x0000000344dc8d90,
}}, {{0}}};

/* (2^1600)^2 mod p */
const struct fp r_squared_mod_p = {{
    0x4fcb7615ca3bf827, 0x4ed307e95e79d5af, 0x06e29709567913fc, 0x56f9c60f4fdd3a85, 
    0x34c70078e3657510, 0x0c458ca691f1a3b0, 0xbeb4f84508bcebd7, 0x4484988ef302bd69, 
    0xa7fe5c950a664055, 0xbb35a17ac0a14c81, 0xc4a4892e7cd9ee90, 0x058aa469b8d68419, 
    0x895f39ff982550b6, 0x868df832bb1236de, 0xb9a0b21b0bb87b01, 0x8116c5fafc74642e, 
    0x0101644f1567d30f, 0xc2b2087c91bbb02b, 0xae541787ce17eaa8, 0xb77ba944fb35a981, 
    0xbb9393b77b7a8da2, 0x68ad735c0bca98cf, 0xf1bd51b30f6845cf, 0x1a237d29bd590d19, 
    0x00000000389e97ad,
}};

/* -p^-1 mod 2^64 */
const uint64_t inv_min_p_mod_r = 0xb78dd911c5838145;

/* p - 2 */
const struct uint_custom p_minus_2 = {{
    0xc336d403441d1671, 0x8bf2e7e4803b30e0, 0x2a661acf50bef842, 0x3589309c6d6fb290, 
    0xceb91dd657963803, 0xc643cbd852e1df22, 0x89a53ca2d9ff7be0, 0x4aa06bbd5330aa5c, 
    0xaf0f500678ce43c0, 0xd7ae83d197dd3c3a, 0x4d7ae2e620770445, 0x02061cd2ac3980ef, 
    0x30d3fe85d876c130, 0xda00b17f678b9fd5, 0xcfba1dcf6d5aee50, 0xa8f5bf657c413831, 
    0xae37c79d9310610c, 0x7d3149bc796dc078, 0xb92240db803155b1, 0x2ea2ab0009209605, 
    0x754f4fce8d562a0d, 0xa6c650682fccc2b4, 0x209e45c3864af514, 0x48aaa2630823f4a8, 
    0x00000003bcded628,
}};

const struct uint_custom p_plus_1_f = {{
    0x30cdb500d107459d, 0xa2fcb9f9200ecc38, 0x0a9986b3d42fbe10, 0xcd624c271b5beca4, 0xb3ae477595e58e00, 0x3190f2f614b877c8, 0x22694f28b67fdef8, 0x12a81aef54cc2a97,
    0xabc3d4019e3390f0, 0x75eba0f465f74f0e, 0xd35eb8b9881dc111, 0x00818734ab0e603b, 0x4c34ffa1761db04c, 0x36802c5fd9e2e7f5, 0x73ee8773db56bb94, 0x2a3d6fd95f104e0c,
    0x2b8df1e764c41843, 0x5f4c526f1e5b701e, 0x6e489036e00c556c, 0x4ba8aac002482581, 0x1d53d3f3a3558a83, 0x29b1941a0bf330ad, 0x08279170e192bd45, 0x122aa898c208fd2a,
    0x00000000ef37b58a,
}};

/* (p - 1) / 2 */
const struct uint_custom p_minus_1_halves = {{
    0x619b6a01a20e8b39, 0x45f973f2401d9870, 0x15330d67a85f7c21, 0x9ac4984e36b7d948, 
    0x675c8eeb2bcb1c01, 0x6321e5ec2970ef91, 0x44d29e516cffbdf0, 0x255035dea998552e, 
    0x5787a8033c6721e0, 0xebd741e8cbee9e1d, 0xa6bd7173103b8222, 0x01030e69561cc077, 
    0x9869ff42ec3b6098, 0x6d0058bfb3c5cfea, 0xe7dd0ee7b6ad7728, 0x547adfb2be209c18, 
    0x571be3cec9883086, 0xbe98a4de3cb6e03c, 0xdc91206dc018aad8, 0x9751558004904b02, 
    0x3aa7a7e746ab1506, 0x5363283417e6615a, 0x104f22e1c3257a8a, 0x245551318411fa54, 
    0x00000001de6f6b14,
}};

/* floor(4 sqrt(p)) */
const struct uint_custom four_sqrt_p = {{
    0x9a899cd64c1cd79e, 0x1b0744915c4925c6, 0xe8adf6c067fa8ef2, 0x2399030aec328428, 
    0xb8967d6233162741, 0xbe3ebd6e1e440127, 0x21a61b54355b7f73, 0x0d659f6da0f47cdf, 
    0x1ae49836938caa4f, 0x0d986b782e366f5b, 0x91ae84e5df53b04c, 0x8f4554ad76b62bb8, 
    0x000000000007bbbb,
}};


/* x = 7 has full order on E0; this is 1/(7^2-1). */
const fp first_elligator_rand = {{
    0x092b3dac66979829, 0x40d0b3fc1d398d67, 0x1b2265995fae6fb7, 0x37e3979722a671ad,
    0xc8fea9978660edef, 0x91645813a4982ec0, 0x542e3af074bf6ec3, 0x273c2f8526afd895,
}};


const unsigned cost_ratio_inv_mul = 128; /* TODO figure out exactly */
